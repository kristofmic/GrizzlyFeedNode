#! /app/vendor/node/bin/node

var
  mongoose = require('mongoose'),
  Feed = require('../models/feed');

dbConnect();

Feed.refreshAll()
  .then(function() { console.log('All feeds refreshed.'); })
  .catch(function(err) { console.error('There was an error refreshing...', err || 'No error data.'); })
  .finally(function() {
    process.exit();
  });

function dbConnect() {
  try {
    console.log(process.env.DB_CONNECTION);
    mongoose.connect(process.env.DB_CONNECTION);
  }
  catch(e) {
    console.error('There was an error connecting to the db...', e || 'No error data.');
  }
}